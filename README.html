

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>A brief hands-on introduction on molecular phylogenetic studies &#8212; A hands-on introduction on molecular phylogenetic studies</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'README';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="book/01_intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/intro_phylo.png" class="logo__image only-light" alt="A hands-on introduction on molecular phylogenetic studies - Home"/>
    <script>document.write(`<img src="_static/intro_phylo.png" class="logo__image only-dark" alt="A hands-on introduction on molecular phylogenetic studies - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="book/01_intro.html">
                    A hands-on introduction on molecular phylogenetic studies
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="book/02_why_trees.html">Before starting, why phylogenetic inference?</a></li>
<li class="toctree-l1"><a class="reference internal" href="book/03_what_is_a_tree.html">What is a phylogenetic tree?</a></li>
<li class="toctree-l1"><a class="reference internal" href="book/04_the_root.html">The root of the tree</a></li>
<li class="toctree-l1"><a class="reference internal" href="book/05_write_trees.html">How to write trees</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Phylogenetic analyses in a nutshell</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="book/06_main_steps.html">Main steps for phylogenetic reconstruction</a></li>
<li class="toctree-l1"><a class="reference internal" href="book/07_dependencies.html">Dependencies and softwares</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Species selection</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="book/08.1_species_selection.html"><em>Species</em> selection (step 1)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">A phylogenetic pipeline</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="book/08.2_align.html">Align (step 2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="book/08.3_trim.html">Trim alignment of irrelevant or positions/columns that might add noise (step 3)</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="book/08.4_phylogenetic_analyses.html">Phylogenetic analyses (step 4)</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="book/08.4.1_ML.html">Using a Maximum Likelihood (ML) approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="book/08.4.2_BI.html">Using a Bayesian Inference (BI) approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="book/08.4.3_parsimony.html">Using a parsimony approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="book/08.4.4_combining.html">Combining different approaches.</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tree thinking</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="book/08.5_interpreting_trees.html">Interpreting the tree (step 5)</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="book/08.5.1_methodologically.html">Interpreting the tree from a methodological point of view</a></li>
<li class="toctree-l2"><a class="reference internal" href="book/08.5.2_biologically.html">Interpreting the tree from a biological point of view</a></li>
<li class="toctree-l2"><a class="reference internal" href="book/08.5.3_broad_integration.html">Integrating the tree in a broader evolutionary context</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Conclusion</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="book/09_conclusion.html">Conclusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="book/10_summary.html">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="book/11_further_reading.html">Further reading</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/MiguelMSandin/phylogeniesQuickStart" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/MiguelMSandin/phylogeniesQuickStart/issues/new?title=Issue%20on%20page%20%2FREADME.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/README.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>A brief hands-on introduction on molecular phylogenetic studies</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies-and-softwares-used-for">Dependencies and softwares used for:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#before-starting-why-phylogenetic-inference">Before starting, why phylogenetic inference?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-phylogenetic-tree">What is a phylogenetic tree?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#main-steps-for-phylogenetic-reconstruction">Main steps for phylogenetic reconstruction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#species-selection-step-1"><em>Species</em> selection (step 1)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-root-of-the-tree">What is the root of the tree?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-pipeline">Basic pipeline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#align-step-2">Align (step 2)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trim-alignment-of-redundant-or-low-informative-positions-columns-step-3">Trim alignment of redundant or low informative positions/columns (step 3)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phylogenetic-analyses-step-4">Phylogenetic analyses (step 4)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-maximum-likelihood-ml-approach">Using a Maximum Likelihood (ML) approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-bayesian-inference-bi-approach">Using a Bayesian Inference (BI) approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-parsimony-approach">Using a parsimony approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-different-approaches">Combining different approaches.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreting-the-tree-step-5">Interpreting the tree (step 5)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreting-the-tree-from-a-methodological-point-of-view">Interpreting the tree from a methodological point of view</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreting-the-tree-from-a-biological-point-of-view">Interpreting the tree from a biological point of view</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-well-supported-clade">What is a “well-supported” clade?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#identifying-equivalent-lineages">Identifying equivalent lineages</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integrating-the-tree-in-a-broader-evolutionary-context">Integrating the tree in a broader evolutionary context</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further reading</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="a-brief-hands-on-introduction-on-molecular-phylogenetic-studies">
<h1>A brief hands-on introduction on molecular phylogenetic studies<a class="headerlink" href="#a-brief-hands-on-introduction-on-molecular-phylogenetic-studies" title="Permalink to this heading">#</a></h1>
<p>Here you will find a brief introduction on how to get started with phylogenetic analyses. All examples are given for nucleotide sequences, yet once you have gone through every step, you will feel more confortable to try different models and datasets.</p>
<p>Bear in mind that this is a quick practical guide for phylogenetic inferenceo of nucleotide sequences. I tried to explain only important or crucial concepts for a non-expert audience, so these lines are far from exhaustive and very simplified.</p>
<p>For a rendered version of this readme, have a look at the book at: <a class="reference external" href="https://MiguelMSandin.github.io/phylogeniesQuickStart/">https://MiguelMSandin.github.io/phylogeniesQuickStart/</a></p>
<section id="dependencies-and-softwares-used-for">
<h2>Dependencies and softwares used for:<a class="headerlink" href="#dependencies-and-softwares-used-for" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Sequence visualization</strong>: <a class="reference external" href="https://ormbunkar.se/aliview/">AliView</a> or a much simpler and faster option <a class="reference external" href="http://doua.prabi.fr/software/seaview">SeaView</a></p></li>
<li><p><strong>Sequence alignments</strong>: <a class="reference external" href="https://mafft.cbrc.jp/alignment/software/">MAFFT</a></p></li>
<li><p><strong>Trimming alignment</strong>: <a class="reference external" href="http://trimal.cgenomics.org/downloads">trimAl</a></p></li>
<li><p><strong>Phylogenetic reconstruction</strong>:<a class="reference external" href="https://birc.au.dk/software/rapidnj/">rapidNJ</a>, <a class="reference external" href="https://github.com/stamatak/standard-RAxML">RAxML</a>, <a class="reference external" href="https://github.com/amkozlov/raxml-ng">RAxML-ng</a>, <a class="reference external" href="http://www.iqtree.org/">IQ-TREE</a>, <a class="reference external" href="https://nbisweden.github.io/MrBayes/">MrBayes</a></p></li>
<li><p><strong>Tree visualization</strong>: <a class="reference external" href="http://tree.bio.ed.ac.uk/software/figtree/">figTree</a></p></li>
</ul>
</section>
<section id="before-starting-why-phylogenetic-inference">
<h2>Before starting, why phylogenetic inference?<a class="headerlink" href="#before-starting-why-phylogenetic-inference" title="Permalink to this heading">#</a></h2>
<p>(If you are only interested on the ‘how’, you can directly go to the <a class="reference external" href="https://github.com/MiguelMSandin/phylogeniesQuickStart#summary">summary</a> section).</p>
<p>Phylogenetic inference allows the exploration of <strong>evolutionary relationships</strong> among taxa beyond a pure pair-wise comparison of their differences.<br />
Evolutionary relationships are normally inferred from observed intrinsic properties of a group of organisms such as DNA sequences, protein sequences or morphological traits.<br />
The first molecular phylogenetic analysis was performed by Carl Woese and George Fox (<a class="reference external" href="https://www.pnas.org/doi/full/10.1073/pnas.74.11.5088">Woese and Fox, 1977</a>). They defined the primary domains of life through 16S rRNA characterization. They provided a simple matrix of pairwise comparisons among DNA sequences, yet opened the doors for a much complex field of molecular evolution.<br />
Now a days, when reconstructing evolutionary patterns, we assume common ancestry and a dichotomic diversification of the studied organisms. And the best (or most accepted) way to represent such patterns is the so called <strong>phylogenetic tree</strong>.</p>
</section>
<section id="what-is-a-phylogenetic-tree">
<h2>What is a phylogenetic tree?<a class="headerlink" href="#what-is-a-phylogenetic-tree" title="Permalink to this heading">#</a></h2>
<p>The simplest answer is <strong>a hypothesis</strong> on the evolutionary relationships among the studied set of taxa or <em>phylogenetic species</em>, understanding such <em>species</em> as genes, proteins or specific morphological traits.</p>
<p>A phylogenetic tree represents a comparative analysis that meassures the <strong>accumulated change</strong> between pairs of <em>species</em>, normally meassured in rate of nucleotide substitution and interpreted as evolutionary change. In this sense, the <strong>phylogenetic distance</strong> between two given species is the accumulated horizontal length betweem them, independently of their vertical position in the tree.</p>
<p>Briefly, the structure of a tree is rather simple. A phylogenetic tree assumes a <strong>bifurcating diversification</strong> in which a given <strong>branch</strong> splits into two branches in one given <strong>node</strong>. Each node and all its descendent taxa correspond to a (monophyletic) <strong>clade</strong>. A node with no further descendents is a terminal node and is frequently called <strong>tip or leaf</strong> of the tree, representing the <em>phylogenetic species</em>.</p>
<p>The node gathering all <em>species</em> is called the <strong>root</strong> of the tree, and is normally used to give a biological and evolutionary interpretation of the tree beyond a pure relative comparison among the <em>species</em>. This node, when present, corresponds to the last common ancestor of all <em>species</em> considered in the tree.</p>
<p><img alt="Tree structure" src="https://github.com/MiguelMSandin/phylogeniesQuickStart/blob/main/resources/Figure1_tree_structure.png" /></p>
<p>In terms of formating, the simplest tree format is called <a class="reference external" href="https://en.wikipedia.org/wiki/Newick_format">newick</a>, and it is simply a nested grouping of trees, where tips are separated by commas, and nodes are grouped by parentheses. The example above would look like as follows:<br />
((a,b),((c,d),(e,f)));<br />
Note the semicolon (“;”) terminating the tree.<br />
Branch lengths (or the accumulated change) are provided after the given tip or node separated by a colon (“:”), as follows:<br />
((a:1,b:1),((c:1,d:1),(e:1,f:1)));<br />
And finally, it is possible to add names to the nodes by simply including such names after the given node, as follows:
((a:1,b:1),((c:1,d:1),(e:1,f:1)sub-clade)clade);</p>
</section>
<hr class="docutils" />
<section id="main-steps-for-phylogenetic-reconstruction">
<h2>Main steps for phylogenetic reconstruction<a class="headerlink" href="#main-steps-for-phylogenetic-reconstruction" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://github.com/MiguelMSandin/phylogeniesQuickStart#species-selection-step-1">1.</a> Select your <em>species</em>.  (&lt;– the most important step!)<br />
<a class="reference external" href="https://github.com/MiguelMSandin/phylogeniesQuickStart#align-step-2">2.</a> Align sequences.<br />
<a class="reference external" href="https://github.com/MiguelMSandin/phylogeniesQuickStart#trim-alignment-of-redundant-or-low-informative-positionscolumns-step-3">3.</a> Remove irrelevant or positions/columns that add noise.<br />
<a class="reference external" href="https://github.com/MiguelMSandin/phylogeniesQuickStart#phylogenetic-analyses-step-4">4.</a> Run phylogenetic inference.<br />
<a class="reference external" href="https://github.com/MiguelMSandin/phylogeniesQuickStart#interpreting-the-tree-step-6">5.</a> Understand your phylogenetic tree.  (&lt;– the most important step!)<br />
6. Come back to step 1, if needed.</p>
<p>The most important steps of phylogenetic inference are the <strong><em>species</em> selection</strong> and the <strong>interpretation of your resulting tree</strong>. Yet, to be able to fully understand a phylogenetic tree, you need to understand how to build it. Here we will quickly go through every step. Yet keep in mind that <strong>each tree is a hypothesis</strong> of your given data, and therefore the selection of your <em>species</em>, the phylogenetic inference and the interpretation of the tree will highly rely on your <strong>scientific question</strong>.</p>
</section>
<hr class="docutils" />
<section id="species-selection-step-1">
<h2><em>Species</em> selection (step 1)<a class="headerlink" href="#species-selection-step-1" title="Permalink to this heading">#</a></h2>
<p>As for any other project or analysis, the most important aspect is your <strong>scientific question</strong>. Why do you want to infer a phylogeny? What is the importance of the phylogeny for your study? How other studies will benefit from your phylogeny?</p>
<p>If you have recently sequenced some organisms and you simply want to have a rough idea of what taxonomic identity these sequences belong to, maybe a <a class="reference external" href="https://blast.ncbi.nlm.nih.gov/Blast.cgi?PROGRAM=blastn&amp;PAGE_TYPE=BlastSearch&amp;LINK_LOC=blasthome">BLAST</a> or a pair-wise comparison to reference databases (such as <a class="reference external" href="https://pr2-database.org/">PR2</a> or <a class="reference external" href="https://www.arb-silva.de/">SILVA</a>) is more suited to your question.</p>
<p>Anyways, <strong>retrieving closely related sequences or proteins</strong> from public databases might be the first step towards the selection of the <em>species</em> that will be included in the phylogenetic tree. Here you are interested in integrating your group of interest in a broader evolutionary context, either within other groups or to explore the relationships within your group of interest. And to do so, you need a good representation of all known diversity.</p>
<p>Unfortunately, accessing all known diversity is not a straight forward task. <strong>Artefacts</strong>, such as <a class="reference external" href="https://en.wikipedia.org/wiki/Chimera_(molecular_biology)">chimeric sequences</a> produced during amplification or errors during amplification or sequencing, might affect the quality and reliability of the molecular diversity. Therefore, and once again, depending on your scientific question you might tackle this step differently.</p>
<p>Let’s suppose that you have sequenced one organism that have never been sequenced and you want to know its phylogenetic patterns. A quick BLAST will let you know what broad group you are dealing with. Now comes the <strong>literature research</strong>: check previous phylogenetic analysis of the group of interest and try to retrieve similar sequences that have been previoulsy used in other studies and complement with newly available sequences.<br />
I normally prefer to start from few and well established sequences of my group of interest and then remove and add more sequences in consecutive phylogenetic runs, depending on the given results and my question.</p>
<p>Closely related sequences will allow you accessing the phylogenetic relationships of your group of interest. Yet, to infer an evolutionary history and get a broader context of your group of interest it is needed to “order” the tree in an evolutionary sense: we need to <strong>root the tree</strong>.</p>
<section id="what-is-the-root-of-the-tree">
<h3>What is the root of the tree?<a class="headerlink" href="#what-is-the-root-of-the-tree" title="Permalink to this heading">#</a></h3>
<p>The root of the tree represents the <strong>last common ancestor</strong> of all <em>species</em> in the tree. It tells you what are the earliest diverging nodes and therefore the “direction” of the evolution.</p>
<p>In the example below, you have the exact same tree rooted (right) and unrooted (left). In this example the root is splitting the first diverging clade (gathering “a” and “b”) and the rest of the taxa.</p>
<p><img alt="Unrooted and rooted tree" src="https://github.com/MiguelMSandin/phylogeniesQuickStart/blob/main/resources/Figure2_tree_root.png" /></p>
<p>When it comes to real data, you might be interested in the closest relatives of your group of interest (or <strong>outgroup</strong>) that are not your group of interest (or <strong>ingroup</strong>). For example if your group of interest are birds, then you might want to choose an outgroup within reptiles.</p>
<p>And if you are unsure of the quality or nature of your sequences, chosing more than one outgroup is very important to quickly spot artefacts or alignment problems.</p>
<p>Chosing a correct outgroup(s) is as important as chosing the correct <em>species</em> for your ingroup. However, many times it is simply not possible to choose, because of (for example) lack of ressolved phylogenetic patterns, so you will have to take a decission among different options.</p>
</section>
</section>
<hr class="docutils" />
<section id="basic-pipeline">
<h2>Basic pipeline<a class="headerlink" href="#basic-pipeline" title="Permalink to this heading">#</a></h2>
<blockquote>
<div><p>Please, bear in mind that there are many different ways to infer phylogenetic patterns among genes, proteins or even morphological characters (or other traits). Here I will just guide you through a basic step-by-step pipeline that I normally use for quick and exploratory analyses of DNA sequences.</p>
</div></blockquote>
<p>We have already selected our <em>species</em> (both ingroup and outgroup or outgroups), let’s build now a phylogenetic tree.</p>
<p>First we set the variable name of our input fasta file as follows:<br />
<code class="docutils literal notranslate"><span class="pre">FASTA=&quot;file.fasta&quot;</span></code>  # The raw fasta file<br />
And we call the output files as follows:<br />
<code class="docutils literal notranslate"><span class="pre">ALIGNED=${INPUT/.fasta/_align.fasta}</span></code>  # The aligned fasta file<br />
<code class="docutils literal notranslate"><span class="pre">FILE=${ALIGNED/.fasta/_trimed.fasta}</span></code>  # The aligned and trimmed fasta file ready for phylogenetic inference<br />
<code class="docutils literal notranslate"><span class="pre">OUTPUT=&quot;test1&quot;</span></code>  # The basic tree name</p>
</section>
<hr class="docutils" />
<section id="align-step-2">
<h2>Align (step 2)<a class="headerlink" href="#align-step-2" title="Permalink to this heading">#</a></h2>
<p>Different genes evolve at different rates, and so does different regions of the gene. Therefore, we have to make the sequences comparable to one another so we can actually estimate divergence from different regions of different sequences that share a functional or structural role. And to do so, we have to <strong>align</strong> the sequences.</p>
<p><img alt="Step2 align sequences" src="https://github.com/MiguelMSandin/phylogeniesQuickStart/blob/main/resources/Figure3_step2_align.png" /></p>
<p>For example using <strong>MAFFT</strong>, for large dataset I normally use the default options:<br />
<code class="docutils literal notranslate"><span class="pre">mafft</span> <span class="pre">$FASTA</span> <span class="pre">&gt;</span> <span class="pre">$ALIGNED</span></code><br />
For a small dataset (&lt;200 sequences) of different groups, I normally use:<br />
<code class="docutils literal notranslate"><span class="pre">mafft</span> <span class="pre">--maxiterate</span> <span class="pre">1000</span> <span class="pre">--localpair</span> <span class="pre">$FASTA</span> <span class="pre">&gt;</span> <span class="pre">$ALIGNED</span></code><br />
And for a small dataset (&lt;200 sequences of similarish length) of closely related group, I normally use:<br />
<code class="docutils literal notranslate"><span class="pre">mafft</span> <span class="pre">--maxiterate</span> <span class="pre">1000</span> <span class="pre">--globalpair</span> <span class="pre">$FASTA</span> <span class="pre">&gt;</span> <span class="pre">$ALIGNED</span></code></p>
<p>Depending on the sequences you are aligning you may want to play with the different options that MAFFT offer. I recommend playing with them and with different datasets (highly similar and highly divergent sequences) to fully understand them.</p>
<p>It is important to manually check the alignment in AliView (or SeaView) if you are working with recently sequenced sequences or of doubted origin. There might be some misalignment or weird stuff easy to spot due to bad quality or errors sequencing.</p>
<p>Other softwares offer other possibilities, for example <a class="reference external" href="http://www.drive5.com/muscle/">muscle</a> (very useful for proteins) stores ambiguities or alignment errors for downstream analysis, and <a class="reference external" href="http://www.clustal.org/omega/">clustal</a> uses a <a class="reference external" href="https://www.ebi.ac.uk/training/online/courses/pfam-creating-protein-families/what-are-profile-hidden-markov-models-hmms">HMM profile</a> to generate the alignment. Further posibilities can be found at the <a class="reference external" href="https://www.ebi.ac.uk/Tools/msa/">EMBL-EBI</a>.</p>
<p>It is also possible (yet requires experience) to align the sequences based on complementary regions of the hypothetical 2D structure of the given coding gene or rDNA (if known).</p>
</section>
<hr class="docutils" />
<section id="trim-alignment-of-redundant-or-low-informative-positions-columns-step-3">
<h2>Trim alignment of redundant or low informative positions/columns (step 3)<a class="headerlink" href="#trim-alignment-of-redundant-or-low-informative-positions-columns-step-3" title="Permalink to this heading">#</a></h2>
<p>In this step we want to remove position that might be irrelevant or add noise.</p>
<p><img alt="Step3 trim alignment" src="https://github.com/MiguelMSandin/phylogeniesQuickStart/blob/main/resources/Figure4_step3_trim.png" /></p>
<p>We can automatically do that with <strong>trimAl</strong> as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">trimal</span> <span class="pre">-in</span> <span class="pre">$ALIGNED</span> <span class="pre">-out</span> <span class="pre">$FILE</span> <span class="pre">-gt</span> <span class="pre">X</span></code></p>
<p>Being X the coverage threshold at a given position. I normally use 30% for a quick analysis and 5% for a more resolutive analysis. Again, depending on your scope you will have to play with different options. Other useful options are “<code class="docutils literal notranslate"><span class="pre">-st</span></code>” (removing positions above certain dissimilarity threshold), “<code class="docutils literal notranslate"><span class="pre">-nogaps</span></code>” (removing all positions with gaps) and “<code class="docutils literal notranslate"><span class="pre">-noallgaps</span></code>” (removing only positions composed only by gaps).</p>
<p>Other sofwares highly used are <a class="reference external" href="http://molevol.cmima.csic.es/castresana/Gblocks.html">Gblocks</a>, <a class="reference external" href="https://github.com/JLSteenwyk/ClipKIT">ClipKIT</a> (which also estimates and keeps parsimonious sites), <a class="reference external" href="http://www.bioinf.uni-leipzig.de/Software/noisy/">Noisy</a> (able to predict and remove homoplastic sites) or <a class="reference external" href="http://gensoft.pasteur.fr/docs/BMGE/1.12/BMGE_doc.pdf">BMGE</a> (removing sites that are highly variable/entropic).</p>
</section>
<hr class="docutils" />
<section id="phylogenetic-analyses-step-4">
<h2>Phylogenetic analyses (step 4)<a class="headerlink" href="#phylogenetic-analyses-step-4" title="Permalink to this heading">#</a></h2>
<p>The alignment provides now a basis to meassure differences/similarities among sequences. A pairwise comparison between group of <em>species</em> gives a first quick look of the alignment and the <em>species</em> themselves.<br />
Yet, the phylogenetic relatedness is not directly link to the similarity or dissimilarity of the <em>species</em>, since not every difference of nucleotide has the same evolutionary consequence. Besides, some columns of the alignment will be prone to be more conservative and others to be more variable. Therefore the same nucleotide change may imply different weight depending on their position in the alignment. Different <a class="reference external" href="https://en.wikipedia.org/wiki/Models_of_DNA_evolution"><strong>models of evolution</strong></a> assume different parameters resulting in different rates of evolution among the same sequences, and allows comparing not only <em>species</em> but also different columns of the alignment.</p>
<p>The simplest tree is a <strong>Neighbor Joining</strong> tree, where <em>species</em> are grouped together based on similarity, until there is no more <em>species</em> left. And the simplest model of evolution is the so-called <strong>Jukes-Cantor</strong> model (<a class="reference external" href="https://doi.org/10.1016/B978-1-4832-3211-9.50009-7">Jukes and Cantor, 1969</a>) assuming equal base frequencies and equal mutation rates. In a slightly more complex model, <strong>Motoo Kimura</strong> included two more parmeters for the different implications of <a class="reference external" href="https://en.wikipedia.org/wiki/Transition_(genetics)">transitions</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/Transversion">transverions</a> in the evolutionary rate (<a class="reference external" href="https://link.springer.com/article/10.1007/BF01731581">Kimura, 1980</a>).</p>
<p><code class="docutils literal notranslate"><span class="pre">rapidnj</span> <span class="pre">$FILE</span> <span class="pre">&gt;</span> <span class="pre">${OUTPUT}_NJ.tre</span></code></p>
<p><img alt="Step4.1" src="https://github.com/MiguelMSandin/phylogeniesQuickStart/blob/main/resources/Figure5_step4.1_model_of_evolution.png" /></p>
<p>More complex models of evolution rely on many assumptions and parameters that need to be estimated, adjusted and improved in order to better fit the given dataset. Such fit is normally measssured by the <strong>likelihood</strong> (or more precissely the logarithmic of the likelihood) and in essence it tells you the probability to observe your data given the model. In the case of phylogenetic inference, we can translate this definition as how well your tree (or model and its parameters) explains your sequence alignment (or data). And to find the highest possible likelihood, several approaches have been proposed:</p>
<section id="using-a-maximum-likelihood-ml-approach">
<h3>Using a Maximum Likelihood (ML) approach<a class="headerlink" href="#using-a-maximum-likelihood-ml-approach" title="Permalink to this heading">#</a></h3>
<p>Maximum Likelihood (<a class="reference external" href="https://link.springer.com/article/10.1007/BF01734359">Felsenstein, 1981</a>) maximizes model parameters (treated as constants) accross different <a class="reference external" href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)">bootstraps</a> (or “replicates”) to find a higher likelihood.</p>
<p>At the end, all the different replicates can be summarized into a <strong>consensus</strong> tree <strong>or</strong> simply take the <strong>best likelihood scoring</strong> tree. Either way, nodes can be annotated on the basis of how many times this given node have appeared accross the different bootstraps, which is refer to as the <strong>bootstrap support</strong> (from 1 to 100).</p>
<p><img alt="Step4.2" src="https://github.com/MiguelMSandin/phylogeniesQuickStart/blob/main/resources/Figure6_step4.2_ML.png" /></p>
<p>We need now new variables:</p>
<p><code class="docutils literal notranslate"><span class="pre">THREADS=2</span></code> # Normally 1 thread for every 500-1000bp alignment positions works fine.<br />
<code class="docutils literal notranslate"><span class="pre">BS=100</span></code>  # The number of Bootstraps</p>
<p>Here you have different softwares:</p>
<p>The first example with <strong>RAxML</strong>:<br />
<code class="docutils literal notranslate"><span class="pre">raxmlHPC-PTHREADS-SSE3</span> <span class="pre">-n</span> <span class="pre">${OUTPUT}_raxml-GTRgamma</span> <span class="pre">-s</span> <span class="pre">$FILE</span> <span class="pre">-m</span> <span class="pre">GTRGAMMA</span> <span class="pre">-p</span> <span class="pre">$RANDOM</span> <span class="pre">-x</span> <span class="pre">$(date</span> <span class="pre">+%s)</span> <span class="pre">-f</span> <span class="pre">a</span> <span class="pre">-N</span> <span class="pre">$BS</span> <span class="pre">-T</span> <span class="pre">$THREADS</span></code></p>
<p>or faster model and most of the times very similar output:<br />
<code class="docutils literal notranslate"><span class="pre">raxmlHPC-PTHREADS-SSE3</span> <span class="pre">-n</span> <span class="pre">${OUTPUT}_raxml-GTRcat</span> <span class="pre">-s</span> <span class="pre">$FILE</span> <span class="pre">-m</span> <span class="pre">GTRCAT</span> <span class="pre">-c</span> <span class="pre">25</span> <span class="pre">-p</span> <span class="pre">$RANDOM</span> <span class="pre">-x</span> <span class="pre">$(date</span> <span class="pre">+%s)</span> <span class="pre">-f</span> <span class="pre">a</span> <span class="pre">-N</span> <span class="pre">$BS</span> <span class="pre">-T</span> <span class="pre">$THREADS</span></code></p>
<p>With <strong>RAxML-ng</strong> you could use the Graphical User Interface option throught their server: <a class="reference external" href="https://raxml-ng.vital-it.ch/#/">RAxML-NG</a>, or have a look at <a class="reference external" href="https://github.com/MiguelMSandin/phylogeniesKickStart/blob/main/scripts/3.2_RAxML-ng.sh">this script</a> for further details through the comand line.</p>
<p>With <strong>IQ-TREE</strong> you can run <strong>modelTest</strong>, which is used to select the best substitution model fitting your data:</p>
<p><code class="docutils literal notranslate"><span class="pre">MEM=2GB</span></code><br />
<code class="docutils literal notranslate"><span class="pre">iqtree</span> <span class="pre">-s</span> <span class="pre">$FILE</span> <span class="pre">-st</span> <span class="pre">&quot;DNA&quot;</span> <span class="pre">-pre</span> <span class="pre">${OUTPUT}_IQtree</span> <span class="pre">-b</span> <span class="pre">$BS</span> <span class="pre">-seed</span> <span class="pre">$(date</span> <span class="pre">+%s)</span> <span class="pre">-mem</span> <span class="pre">$MEM</span> <span class="pre">-nt</span> <span class="pre">$THREADS</span> <span class="pre">-wbtl</span></code></p>
<p>And if you know the model of evolution to be used you can add it to the command. Most of the times, the best model is the Generalised Time Reversible model (Tabaré, 1986; <em>Lectures Math. Life Sci</em> 17:2,57-86) with a Gamma distribution and proportion of Invariant sites for rate hetereogenity (GTR+G+I, but it also is the most complex model): <code class="docutils literal notranslate"><span class="pre">-m</span> <span class="pre">GTR+I+G</span></code></p>
<p>ModelTest can also be run in <a class="reference external" href="https://www.r-project.org/"><strong>R</strong></a>, with the packages <a class="reference external" href="https://cran.r-project.org/web/packages/ape/index.html"><em>ape</em></a> and <a class="reference external" href="https://cran.r-project.org/web/packages/phangorn/index.html"><em>phangorn</em></a> (see <a class="reference external" href="https://github.com/MiguelMSandin/phylogeniesKickStart/blob/main/scripts/3.5_PhyML_in_R.R">this script</a> for further details).</p>
<p>Once again, different options will address better different questions…</p>
<p>It is important to check the <strong>log</strong> file reporting the different analytical steps. Here you check the likelihood of the tree over the different bootstraps, the model parameters optimization or the proportion of invariant sites in the alignment. Basically, you check that there is indeed an improvement and that the alignment is actually informative.</p>
</section>
<section id="using-a-bayesian-inference-bi-approach">
<h3>Using a Bayesian Inference (BI) approach<a class="headerlink" href="#using-a-bayesian-inference-bi-approach" title="Permalink to this heading">#</a></h3>
<p>Bayesian Inference (<a class="reference external" href="https://link.springer.com/article/10.1007/BF02338839">Rannala and Yang, 1996</a>; <a class="reference external" href="https://academic.oup.com/mbe/article/14/7/717/1119795">Yang and Rannala, 1997</a>) randomly estimates the model parameters accross a statistical distribution resulting in different trees. The likelihood of the trees are computed <em>a posteriori</em> (actually they are approximated by <a class="reference external" href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo">Markov Chain Monte Carlo</a> -MCMC- methods) resulting in <strong>posterior probabilities</strong>, which can be understood as the probability of a tree being right given the randomly selected model parameters.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Bayesian_inference">Bayesian Inference</a> collectes information along the way to update and improve the model parameters. A single inference will most likely yield a rather poor tree, since the search for model parameters is predefined or random (to an extent). Yet in the following <strong>cycles</strong> (sometimes also called iterations, generations or even chains) model parameters are going to be adjusted based on previously collected information resulting in trees with higher and higher likelihood. In this sense, the number of generations will affect the random sampling, and therefore your results.<br />
It is recommended to monitor the likelihood per cycle to be sure that your model optimization is arriving to a <strong>convergence</strong>. Normally, a safe option is to opt for a very long chain, but an excessively long chain might result in a waste of computational resources. If you are interested in a trade-off between ensuring convergence and not spending several days, weeks or months in a redundant analysis you can explore the <a class="reference external" href="https://beast.community/ess_tutorial">Effective Sample Size</a> of the MCMC run in the software <a class="reference external" href="https://beast.community/tracer">Tracer</a>.<br />
Because of the long sampling, when you choose a Bayesian approach it is very important to check the likelihood over the different cycles and remove the “learning slope”, normally referred to as <strong>burn-in</strong>.</p>
<p><img alt="Step4.3" src="https://github.com/MiguelMSandin/phylogeniesQuickStart/blob/main/resources/Figure7_step4.3_BI.png" /></p>
<p>Bayesian approaches are available inmany different softwares. Such as <a class="reference external" href="https://nbisweden.github.io/MrBayes/">MrBayes</a>, <a class="reference external" href="https://beast.community/">BEAST</a>, <a class="reference external" href="https://www.beast2.org/">BEAST2</a> or <a class="reference external" href="http://www.atgc-montpellier.fr/phylobayes/">PhyloBayes</a>. Yet, they need most of the times to be run in different blocks, where different parameters need to be set that will influence your analysis. Instead of running them from a single command, as we did for ML approaches, here we save all our options in a simple text (or xml) file and we run the file within the BI software.</p>
<p>Here you have an example of a script to be run using <strong>MrBayes</strong>, let’s save it as “<strong>phylo_mrBayes.sh</strong>”:<br />
<code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">autoclose=yes</span> <span class="pre">nowarnings=yes</span></code><br />
<code class="docutils literal notranslate"><span class="pre">execute</span> <span class="pre">FILE.nexus</span></code><br />
<code class="docutils literal notranslate"><span class="pre">lset</span> <span class="pre">nst=6</span> <span class="pre">rates=gamma</span></code><br />
<code class="docutils literal notranslate"><span class="pre">mcmc</span> <span class="pre">ngen=10000000</span> <span class="pre">Nruns=3</span> <span class="pre">savebrlens=yes</span> <span class="pre">file=OUTPUT_mrBayesgamma</span></code><br />
<code class="docutils literal notranslate"><span class="pre">sump</span></code><br />
<code class="docutils literal notranslate"><span class="pre">sumt</span></code><br />
<code class="docutils literal notranslate"><span class="pre">quit</span></code></p>
<blockquote>
<div><p>#The mcmc command assumes a burnin of 25%: <code class="docutils literal notranslate"><span class="pre">relburnin=yes</span></code> and <code class="docutils literal notranslate"><span class="pre">burninfrac=0.25</span></code></p>
</div></blockquote>
<p>That can be run as follows:<br />
<code class="docutils literal notranslate"><span class="pre">mb</span> <span class="pre">&lt;</span> <span class="pre">phylo_mrBayes.sh</span> <span class="pre">&gt;</span> <span class="pre">${OUTPUT}_mrBayesgamma.log</span> <span class="pre">&amp;</span></code></p>
<blockquote>
<div><p>Something to bear in mind is that MrBayes uses “nexus” format and not “fasta”. This can be easily exported/transformed in AliView.</p>
</div></blockquote>
<p>Alternatively, you can type each one of the lines from the script that we called <em>phylo_mrBayes.sh</em> directly in the MrBayes prompt (except for the first line, which sets the autoclosing).</p>
<p>And in this script (<a class="reference external" href="https://github.com/MiguelMSandin/phylogeniesQuickStart/blob/main/scripts/3.4.3_phylo_BEAST.xml">phylo_BEAST.xml</a>) you can find an example of a <strong>BEAST</strong> xml file in its most simple format (don’t panic! such xml file can be created through the graphical user interface package <a class="reference external" href="https://beast.community/beauti">BEAUti</a>), that can be run as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">beast</span> <span class="pre">-seed</span> <span class="pre">$RANDOM</span> <span class="pre">-beagle_SSE</span> <span class="pre">phylo_BEAST.xml</span></code><br />
And now we have to summarise the chain with <a class="reference external" href="https://beast.community/treeannotator">treeannotator</a>:<br />
<code class="docutils literal notranslate"><span class="pre">treeannotator</span> <span class="pre">-burnin</span> <span class="pre">1000000</span> <span class="pre">-heights</span> <span class="pre">median</span> <span class="pre">OUTPUT.trees</span> <span class="pre">OUTPUT_mcmc.tre</span></code></p>
<p>The main problem (or advantage, depends on your question) is that BEAST assumes a clock model. But the <a class="reference external" href="https://en.wikipedia.org/wiki/Molecular_clock">molecular clock</a> concept is getting out of scope. If you are very interested, please have a look at this excellent practical guide to molecular dating published by <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1631068313001097">Hervé Sauquet (2013)</a>, and if you already have a solid tree, you can have a look at <a class="reference external" href="http://abacus.gene.ucl.ac.uk/software/MCMCtree.Tutorials.pdf">MCMCTree</a> from the <a class="reference external" href="http://abacus.gene.ucl.ac.uk/software/paml.html">PAML</a> package.</p>
</section>
<section id="using-a-parsimony-approach">
<h3>Using a parsimony approach<a class="headerlink" href="#using-a-parsimony-approach" title="Permalink to this heading">#</a></h3>
<p>The parsimony approach assumes that the minimum number of changes best explains phylogenetic relatedness. Due to the big simplification of the incredibly complex process that is evolution, this approach has been heavily critized and almost abandon. However I believe it is still very usefull to understand and know it exists since parsimony yields very good results when used as starting tree for both ML and BI approaches. Indeed, raxml-ng implements in its pipeline the use of parsimony to estimate the initial tree.<br />
We can quickly have a look at a parsimonious tree as follows with <strong>RAxML</strong>:</p>
<p><code class="docutils literal notranslate"><span class="pre">raxmlHPC-PTHREADS-SSE3</span> <span class="pre">-n</span> <span class="pre">${OUTPUT}_raxml-parsimony-GTRgamma</span> <span class="pre">-s</span> <span class="pre">$FILE</span> <span class="pre">-y</span> <span class="pre">-m</span> <span class="pre">GTRGAMMA</span> <span class="pre">-p</span></code></p>
<p>Besides, as you might have figured out by now, your scientific question is the most important part when it comes to take decission on the methdological approach. In this context, ML and BI yields very good results for complex DNA or protein sequences. But when it comes to <strong>ancestral state reconstruction</strong> of non-neutral traits, such as habitat or specific morphological traits, the simplification of parsimonious approaches seems to result in more plausible hypothesis (<a class="reference external" href="https://www.nature.com/articles/s41598-020-64647-4">Holland et al. 2020</a>). It is important to understand that most of the times such analyses are performed over an already inferred phylogenetic tree, and therefore the analyses is no longer about phylogenetic inferring (but about ancestral state reconstruction). In this context, other softwares (such as <a class="reference external" href="https://www.mesquiteproject.org/">Mesquite</a> or <a class="reference external" href="http://gensoft.pasteur.fr/docs/TNT/1.5/">TNT</a>) and approches (such as <a class="reference external" href="https://en.wikipedia.org/wiki/Maximum_parsimony_(phylogenetics)">Maximum Parsimony</a>) have been developed. My experience in this area is very limited and I do not feel confortable explaining them. Besides, as pointed out by <a class="reference external" href="https://www.nature.com/articles/s41598-020-64647-4">Holland et al. (2020)</a>, ancestral state reconstruction analyses should be considered and evaluated carefully.</p>
<p>My take-home message of parsimony approaches is simply that you are aware they exist and that you might be interested in exploring them further according to your question.</p>
</section>
<section id="combining-different-approaches">
<h3>Combining different approaches.<a class="headerlink" href="#combining-different-approaches" title="Permalink to this heading">#</a></h3>
<p>When the phylogenetic inference is the core of your study, it is highly recommended to <strong>replicate the phylogenetic tree with different approaches</strong>. This is most commonly achieved by combining the support from different trees obtained by independent runs of maximum likelihood <strong>and</strong> bayesian approaches.<br />
Although not always it is possible to apply different approaches to the same dataset, for example for very large datasets a bayesian inference might fail to converge; or when estimating molecular ages a bayesian approach is much better suited since allows uncertainty in the priors.<br />
Other options could be to: (i) use different softwares (RAxML-ng vs. IQ-TREE), (ii) apply different models of evolution (GTR vs. CAT), (iii) or even to replicate the alignment with different softwares, options or reversing the sequences before aligning.</p>
</section>
</section>
<hr class="docutils" />
<section id="interpreting-the-tree-step-5">
<h2>Interpreting the tree (step 5)<a class="headerlink" href="#interpreting-the-tree-step-5" title="Permalink to this heading">#</a></h2>
<p>This might be the most complicated step, and it is only getting easier with experience and after failing many times. We have to remember that the phylogentic tree that we have just inferred in the previous step is <strong>a hypothesis</strong> of the data (and model) we used, and we should always be critical to our initial hypothesis and our methods.</p>
<p>Briefly, you are inferring a phylogenetic tree because it is <strong>a mean to answer your scientific question</strong>. In this sense, you have several interconnected layers to pay attention to. Firstly you want to check if you have correctly built the tree in a pure methodological point of view. Then you want to understand how the tree explains your data within your study, or in other words the results of the tree. And lastly you are interested in discussing the tree in a broader evolutionary context.</p>
<section id="interpreting-the-tree-from-a-methodological-point-of-view">
<h3>Interpreting the tree from a methodological point of view<a class="headerlink" href="#interpreting-the-tree-from-a-methodological-point-of-view" title="Permalink to this heading">#</a></h3>
<p>At this stage you are looking for artefacts, sequences badly aligned (or even in the reverse order), an appropriate trimming threshold that fits to your sequences, enough number of bootstraps/generations, … Briefly, your tree should have:</p>
<ul class="simple">
<li><p>highly supported nodes,</p></li>
<li><p>no polytomies or no near-0 internal branch lengths,</p></li>
<li><p>no <em>very long</em> branches and</p></li>
<li><p>the ingroup different from your outgroup(s), but not <em>too</em> different.<br />
Understanding that each concept is relative and may vary among different trees.</p></li>
</ul>
<p>Simplifying long explanations:</p>
<ul class="simple">
<li><p>Low support in the nodes or near-0 branch lengths (or even <strong>polytomies</strong>) could be because the <em>species</em> are too similar to each other and the model fails to converge. It could also be that such similarity might have been created because of too strict trimming thresholds of the alignment. (<strong>Example 1</strong>)</p></li>
<li><p>Very <strong>long branches</strong> could reflect the opposite problem, in which we have simply selected very distinct <em>species</em>, the quality of the <em>species</em> is bad (with many errors or insertions), the alignment failed or even that the trimming was too gentle. (<strong>Example 2</strong>)</p></li>
<li><p>If the outgroup and the ingroup appear very distant from one another you might have selected the wrong outgroup. Check the literature again and try to select a more related group as an outgroup or try <a class="reference external" href="https://blast.ncbi.nlm.nih.gov/Blast.cgi?PROGRAM=blastn&amp;PAGE_TYPE=BlastSearch&amp;LINK_LOC=blasthome">BLAST</a> to retrieve closely related sequences (if aplicable). (<strong>Example 3</strong>)</p></li>
<li><p>It could also happen that the different outgroups appear not according to the literature and some clades of the ingroup within or between the different outgroups. Then, most likely <strong><a class="reference external" href="https://en.wikipedia.org/wiki/Chimera_(molecular_biology)">chimeric sequences</a></strong> might be present. Chimeric sequences also tend to appear alone at early diverging positions and sometimes at relatively long branches. (<strong>Example 4</strong>)</p></li>
</ul>
<p><img alt="examples_1-4" src="https://github.com/MiguelMSandin/phylogeniesQuickStart/blob/main/resources/Figure8_examples_1-4.png" /></p>
<p>Long branches deserve a special mention when (for example) you have several clades present in independent long branches and are <em>a priori</em> phylogenetically related (sister groups). This effect could be due to the so called <strong>Long Branch Attraction</strong> artefact, and the tree shows two groups closely related but simply because they are very different from all the rest and not necessarily because they are similar (or related) to one another.</p>
<p>When chimeric sequences come from very different parent sequences, it might be easy to spot, since all the topology of the tree might be affected. Specially when using several outgroups. But when the chimera is form from closely related groups might be problematic to identify. Most of the softwares that perform chimeric detection (such as <a class="reference external" href="https://mothur.org/">mothur</a> or <a class="reference external" href="https://github.com/torognes/vsearch">vsearch</a>) rely on the reference database of choice, so you have to be cautious when providing the reference database.</p>
<p>The different topological possibilities of a tree are very big, and therefore any list of possible methodological problems will be far from complete. I hope with the few examples I am providing, you get the rational to identify methodological issues.</p>
</section>
<section id="interpreting-the-tree-from-a-biological-point-of-view">
<h3>Interpreting the tree from a biological point of view<a class="headerlink" href="#interpreting-the-tree-from-a-biological-point-of-view" title="Permalink to this heading">#</a></h3>
<p>A pure methodological examination of a tree is very important to help you identify problematic steps on the pipeline. However a biological interpretation of your tree goes tightly connected. Understanding the tree from a biological point of view helps to resolve or neglect potential issues identified from a pure methodological point of view and eventually, it will contribute to decide on whether keeping or removing certain <em>species</em>.<br />
For example:</p>
<ul class="simple">
<li><p>As we have seen in the methodological check, near-0 internal branchelengths or poorly supported nodes might be a problem. But if you find highly supported clades and only few unressolved internal nodes with very short branches, the problem might be intrinsic to the <em>species</em> and simply phylogenetic patterns can’t be ressolved with the given data. We normally interpret such events in terms of evolution as that “the diversification happened very fast”. (<strong>Example 5</strong>).</p></li>
<li><p>Similarly, long branches can have a biological meaning despite a correct methodological approach. The <strong>rate of evolution</strong> among eukaryotes varies widely from clade to clade. In this sense one specific clade with a very diverging trait can appear in a long branch, highly supported within it, but very poorly resolved regarding its position in the tree. In this case, resolving it’s phylogenetic relationship among other groups is not possible with the given data. The best option would be to choose a different trait (if possible) and discuss the different approaches. (<strong>Example 6</strong>).</p></li>
<li><p>A very common source of conflict is the presence of contaminations or mislabeled sequences. The true information for phylogenetic analysis is the actual gene or protein sequence. Yet the name of such sequence (either taxonomical, environmental or other associated metadata) is an identifier for human readability. Therefore the identifier should we treated with coution and interpreted according to your scope and methodological analyses regardless of its origin. (<strong>Example 7</strong>).</p></li>
<li><p>When combining different genes or proteins (aslo called as concatenation) it might happen that they show different phylogenetic patterns. In this case it is important to understand the nature of those genes or proteins and discuss the results accordingly. They might have different evolutionary rates, different selection pressure, different phylogenetic information or even different lengths regarding the rest of the sequences in the alignment or being badly annotated. (<strong>Example 8</strong>).</p></li>
<li><p>…</p></li>
</ul>
<p><img alt="examples_5-8" src="https://github.com/MiguelMSandin/phylogeniesQuickStart/blob/main/resources/Figure9_examples_5-8.png" /></p>
<section id="what-is-a-well-supported-clade">
<h4>What is a “well-supported” clade?<a class="headerlink" href="#what-is-a-well-supported-clade" title="Permalink to this heading">#</a></h4>
<p>Identifying well defined clades is a difficult task and there are no universal thresholds to define such a thing.<br />
For example: when using only one or two genes, if a clade has &gt;90% bootstrap or &gt;0.9 posterior probabilities you can be very confident of the support of that clade. On the contrary, if a clade has &lt;60% BS or &lt;0.6%, that specific clade might be close to random selection. When using multiple concatenation of genes, these threshold could increase considerably, and not relying on a clade that has 85% BS or 0.85 PP.<br />
Besides, the tree topology might influence on the decision of calling a clade “well-supported”. Therefore and once again, this might depend on the scope of your analysis and the data used.</p>
</section>
<section id="identifying-equivalent-lineages">
<h4>Identifying equivalent lineages<a class="headerlink" href="#identifying-equivalent-lineages" title="Permalink to this heading">#</a></h4>
<p>Similarly to the previous subsection, identifying equivalent lineages will depend on the data used, the tree topology and the support of the clades. However, if two independent clades have similar branch lengths and their distance to the root is somehow similar, we cn argue that their hierarchical classification might be similar (i.e.; class, order, family).</p>
</section>
</section>
<section id="integrating-the-tree-in-a-broader-evolutionary-context">
<h3>Integrating the tree in a broader evolutionary context<a class="headerlink" href="#integrating-the-tree-in-a-broader-evolutionary-context" title="Permalink to this heading">#</a></h3>
<p>We have performed a technical check of the tree, and seems OK with the exceptions of few minor technical discrepancies. We have interpreted those discrepancies from a biological point of view, and they are easily explained with the given dataset.<br />
Now we can pay attention to the identifiers from the tree tips and build an evolutionary hypothesis for our tree. It is time to integrate the previous interpretations with the rest of the information we had before inferring the phylogenetic tree.<br />
If your scope was ecological, do you find any ecological pattern? If you performed a morphological and molecular characterization, do you find any morphological pattern? How is it comparing with your initial hypothesis? Your work now will be to find those patterns, they might or they might not agree with the previous knowledge.</p>
<p><img alt="Integrating knowledge" src="https://github.com/MiguelMSandin/phylogeniesQuickStart/blob/main/resources/Figure10_examples_9.png" /></p>
<p>Lastly, it is important to integrate the meaning of your tree in the current state of the art. What is your tree bringing to the current state of the art of your field? How is it comparing to the previous existing knowledge?</p>
</section>
</section>
<hr class="docutils" />
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">#</a></h2>
<p>Phylogenetic trees are hypotheses of the given data, dependent from a specific methodological approach. Therefore it is of paramount importance to adjust as far as possible your dataset and your methods to the scope of your scientific question. Even the same question, if tackled from different methods and datasets, might result in different or even contradicting hypotheses. And yet, such both hypotheses might be correct, they will just represent <strong>different pictures of the same reality</strong>.<br />
Let’s imagine going somewhere beyond the tropics and take the a picture in the exact same location through the different season. Or going within the tropics but changing the zoom throughout different pictures. In the first example we only changed the time, whereas in the second the method.</p>
<p>Evolution and diversification are complex processes that we tend to simplify with trees, networks or even more elaborated stories. Yet such representations only tell one part of the story, since it is basically impossible to cover all different aspects of evolution.<br />
Selection occurs at many different levels from genes to ecosystems, going through traits, organisms, holobionts, populations and communities. Such diversity levels also interact within and between them creating a reticulate system where a linear story simply represents one hypothesis from a given point of view.</p>
<p>Phylogenetic patterns are constantly changing with new tools being developed that allow accessing nw aspects of the biological diversity, its exploration and analysis. In this sense, our job as scientists is to integrate all the different knowledge into a comprehensive story coming from many different angles, being critical about the data we are using and aware of the limitations of the methods we are applying.</p>
<p><img alt="Different pictures of the same reality" src="https://github.com/MiguelMSandin/phylogeniesQuickStart/blob/main/resources/Figure11_different_pictures_of_the_same_reality.png" /></p>
</section>
<hr class="docutils" />
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h2>
<p><strong>Step 1</strong>. <strong>Select your <em>species</em> carefully</strong>, both the ingroup and the outgroup, depending on your <strong>scientifc question</strong>.</p>
<p>Set the variables:<br />
<code class="docutils literal notranslate"><span class="pre">FASTA=&quot;file.fasta&quot;</span></code><br />
<code class="docutils literal notranslate"><span class="pre">ALIGNED=${INPUT/.fasta/_align.fasta}</span></code><br />
<code class="docutils literal notranslate"><span class="pre">FILE=${ALIGNED/.fasta/_trimed.fasta}</span></code><br />
<code class="docutils literal notranslate"><span class="pre">OUTPUT=&quot;test1&quot;</span></code><br />
<code class="docutils literal notranslate"><span class="pre">THREADS=2</span></code><br />
<code class="docutils literal notranslate"><span class="pre">BS=100</span></code><br />
<code class="docutils literal notranslate"><span class="pre">MEM=&quot;2GB&quot;</span></code></p>
<p><strong>Step 2</strong>. Align the sequences:<br />
<code class="docutils literal notranslate"><span class="pre">mafft</span> <span class="pre">$FASTA</span> <span class="pre">&gt;</span> <span class="pre">$ALIGNED</span></code></p>
<p><strong>Step 3</strong>. Manual check of the alignment if unsure of the quality of the sequences before trimming:<br />
<code class="docutils literal notranslate"><span class="pre">trimal</span> <span class="pre">-in</span> <span class="pre">$ALIGNED</span> <span class="pre">-out</span> <span class="pre">$FILE</span> <span class="pre">-gt</span> <span class="pre">05</span></code></p>
<p><strong>Step 4</strong>. Run a phylogeny using a <strong>Maximum Likelihood</strong> approach:<br />
with <strong>RAxML</strong>:<br />
<code class="docutils literal notranslate"><span class="pre">raxmlHPC-PTHREADS-SSE3</span> <span class="pre">-n</span> <span class="pre">${OUTPUT}_raxml-GTRgamma</span> <span class="pre">-s</span> <span class="pre">$FILE</span> <span class="pre">-m</span> <span class="pre">GTRGAMMA</span> <span class="pre">-p</span> <span class="pre">$RANDOM</span> <span class="pre">-x</span> <span class="pre">$(date</span> <span class="pre">+%s)</span> <span class="pre">-f</span> <span class="pre">a</span> <span class="pre">-N</span> <span class="pre">$BS</span> <span class="pre">-T</span> <span class="pre">2</span></code><br />
and/or <strong>RAxML-ng</strong>:<br />
<code class="docutils literal notranslate"><span class="pre">raxml-ng</span> <span class="pre">--all</span> <span class="pre">--msa</span> <span class="pre">$FILE</span> <span class="pre">--model</span> <span class="pre">GTR+G</span> <span class="pre">--tree</span> <span class="pre">pars{10}</span> <span class="pre">--prefix</span> <span class="pre">${OUTPUT}_raxml-ng-GTRgamma</span> <span class="pre">--seed</span> <span class="pre">$RANDOM</span> <span class="pre">--threads</span> <span class="pre">$THREADS</span> <span class="pre">--bs-trees</span> <span class="pre">$BS</span></code><br />
and/or <strong>IQ-TREE</strong>:<br />
<code class="docutils literal notranslate"><span class="pre">iqtree</span> <span class="pre">-s</span> <span class="pre">$FILE</span> <span class="pre">-st</span> <span class="pre">&quot;DNA&quot;</span> <span class="pre">-pre</span> <span class="pre">${OUTPUT}_IQtree-mt</span> <span class="pre">-b</span> <span class="pre">$BS</span> <span class="pre">-seed</span> <span class="pre">$(date</span> <span class="pre">+%s)</span> <span class="pre">-mem</span> <span class="pre">$MEM</span> <span class="pre">-nt</span> <span class="pre">$THREADS</span> <span class="pre">-wbtl</span></code><br />
and/or using a <strong>Bayesian Inference</strong> approach with <strong>MrBayes</strong> (you can find an example script here: <a class="reference external" href="https://github.com/MiguelMSandin/phylogeniesQuickStart/blob/main/scripts/3.4.1_MrBayes_set.sh">phylo_mrBayes.sh</a>):<br />
<code class="docutils literal notranslate"><span class="pre">mb</span> <span class="pre">&lt;</span> <span class="pre">phylo_mrBayes.sh</span> <span class="pre">&gt;</span> <span class="pre">${OUTPUT]_mrBayesgamma.log</span></code></p>
<p><strong>Step 5</strong>. <strong>Interpret your phylogenetic tree</strong>.<br />
First from a <strong>methodological point of view</strong>: Are all nodes highly supported? Are there no polytomic nodes? Are there no long branches?<br />
Then we add the <strong>biological thinking</strong>: Are the outgroups clearly defined and independent from the ingroup? Are the patterns among clades as previously reported/suggested/expected? Can you explain the tree topology according to the <em>species</em> you used (e.g.; rRNA genes, plastids, proteins)?<br />
Lastly we add a <strong>broader context</strong>: can you explain the tree in a biological integrative context? For example if using genes/proteins, can you explain it from a morphological or ecological point of view? What is contributing to the state of the art of your research?<br />
If not, then you should come back to <strong>Step 1</strong>, think again on the chosen <em>species</em>, try different alignment options and/or try to use different trimming options more suited to your scientific question.</p>
</section>
<hr class="docutils" />
<section id="further-reading">
<h2>Further reading<a class="headerlink" href="#further-reading" title="Permalink to this heading">#</a></h2>
<p><strong>Phylogenetic tree thinking</strong>: Interpreting phylogenetic trees seems <em>a priori</em> a simple task, since it is indeed a simple representation of a dichotomic diversification. Yet as we have seen throughout this crash course, a phylogenetic tree might lead to misinterpretation when not interpreted from an integrative methodological and biological perspective (<a class="reference external" href="https://evolution-outreach.biomedcentral.com/articles/10.1007/s12052-010-0254-9">Meisel 2010</a>). In this context, a single tree provides one version of a very complex process that requires a criticial thinking and interpretion from many different points of view (<a class="reference external" href="https://www.pnas.org/doi/full/10.1073/pnas.0610699104">Doolitle and Bapteste, 2007</a>).</p>
<p>Regarding the methodological aspect of phylogenetic reconstruction, models and parameters you can directly check in the (most of the times) very well documented hands-on tutorials of the open source softwares I introduced here. Besides, I highly encourage you to extend your possiblities and go fancy in phylogenetic inference by looking and epxloring different options through the help command (i.e.; <code class="docutils literal notranslate"><span class="pre">iqtree</span> <span class="pre">-h</span></code>, <code class="docutils literal notranslate"><span class="pre">raxml-ng</span> <span class="pre">-h</span></code>), or through their online manuals and hands-on tutorials:</p>
<ul class="simple">
<li><p>RAxML (not maintained any more): <a class="github reference external" href="https://github.com/stamatak/standard-RAxML/blob/master/manual/NewManual.pdf">stamatak/standard-RAxML</a></p></li>
<li><p>RAxML-NG: <a class="github reference external" href="https://github.com/amkozlov/raxml-ng/wiki/Tutorial">amkozlov/raxml-ng</a></p></li>
<li><p>IQtree: <a class="reference external" href="http://www.iqtree.org/doc/Quickstart">http://www.iqtree.org/doc/Quickstart</a></p></li>
<li><p>MrBayes: <a class="github reference external" href="https://github.com/NBISweden/MrBayes/blob/develop/doc/manual/Manual_MrBayes_v3.2.pdf">NBISweden/MrBayes</a></p></li>
<li><p>R: ape and phangorn: <a class="reference external" href="https://cran.r-project.org/web/packages/phangorn/vignettes/Trees.html">https://cran.r-project.org/web/packages/phangorn/vignettes/Trees.html</a></p></li>
<li><p>BEAST: <a class="reference external" href="https://beast.community/first_tutorial">https://beast.community/first_tutorial</a>.</p></li>
<li><p>BEAST2: <a class="reference external" href="https://www.beast2.org/tutorials/">https://www.beast2.org/tutorials/</a></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies-and-softwares-used-for">Dependencies and softwares used for:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#before-starting-why-phylogenetic-inference">Before starting, why phylogenetic inference?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-phylogenetic-tree">What is a phylogenetic tree?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#main-steps-for-phylogenetic-reconstruction">Main steps for phylogenetic reconstruction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#species-selection-step-1"><em>Species</em> selection (step 1)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-root-of-the-tree">What is the root of the tree?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-pipeline">Basic pipeline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#align-step-2">Align (step 2)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trim-alignment-of-redundant-or-low-informative-positions-columns-step-3">Trim alignment of redundant or low informative positions/columns (step 3)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phylogenetic-analyses-step-4">Phylogenetic analyses (step 4)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-maximum-likelihood-ml-approach">Using a Maximum Likelihood (ML) approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-bayesian-inference-bi-approach">Using a Bayesian Inference (BI) approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-parsimony-approach">Using a parsimony approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-different-approaches">Combining different approaches.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreting-the-tree-step-5">Interpreting the tree (step 5)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreting-the-tree-from-a-methodological-point-of-view">Interpreting the tree from a methodological point of view</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreting-the-tree-from-a-biological-point-of-view">Interpreting the tree from a biological point of view</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-well-supported-clade">What is a “well-supported” clade?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#identifying-equivalent-lineages">Identifying equivalent lineages</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integrating-the-tree-in-a-broader-evolutionary-context">Integrating the tree in a broader evolutionary context</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further reading</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Miguel M. Sandin
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>